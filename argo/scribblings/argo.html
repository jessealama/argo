<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html class="toc"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>Argo: JSON Schema Adventures</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="file:///Users/jesse/Dropbox/sources/argo/scribblings/argo.html" class="tocviewselflink" data-pltdoc="x">Argo:<span class="mywbr"> &nbsp;</span> JSON Schema Adventures</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="file:///Users/jesse/Dropbox/sources/argo/scribblings/argo.html#%28part._.Installation%29" class="tocviewlink" data-pltdoc="x">Installation</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="file:///Users/jesse/Dropbox/sources/argo/scribblings/argo.html#%28part._.Running_.Argo%29" class="tocviewlink" data-pltdoc="x">Running Argo</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="file:///Users/jesse/Dropbox/sources/argo/scribblings/argo.html#%28part._.Library_interface%29" class="tocviewlink" data-pltdoc="x">Library interface</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="file:///Users/jesse/Dropbox/sources/argo/scribblings/argo.html#%28part._.Technical_information%29" class="tocviewlink" data-pltdoc="x">Technical information</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="file:///Users/jesse/Dropbox/sources/argo/scribblings/argo.html#%28part._.Shortcomings_and_sorely_missing_features%29" class="tocviewlink" data-pltdoc="x">Shortcomings and sorely missing features</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="file:///Users/jesse/Dropbox/sources/argo/scribblings/argo.html#%28part._.Further_reading%29" class="tocviewlink" data-pltdoc="x">Further reading</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._.Argo__.J.S.O.N_.Schema_.Adventures%29" class="tocsubseclink" data-pltdoc="x">Argo:<span class="mywbr"> &nbsp;</span> JSON Schema Adventures</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#%28part._.Installation%29" class="tocsubseclink" data-pltdoc="x">Installation</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#%28part._.Running_.Argo%29" class="tocsubseclink" data-pltdoc="x">Running Argo</a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#%28part._validate%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">validate</span></a></td></tr><tr><td><span class="tocsublinknumber">2.1.1<tt>&nbsp;</tt></span><a href="#%28part._validate-exit-code%29" class="tocsubseclink" data-pltdoc="x">Exit code</a></td></tr><tr><td><span class="tocsublinknumber">2.1.2<tt>&nbsp;</tt></span><a href="#%28part._.Options%29" class="tocsubseclink" data-pltdoc="x">Options</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#%28part._.Library_interface%29" class="tocsubseclink" data-pltdoc="x">Library interface</a></td></tr><tr><td><a href="#%28def._%28%28lib._argo%2Fmain..rkt%29._json-schema~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">json-<wbr></wbr>schema?</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._argo%2Fmain..rkt%29._adheres-to-schema~3f%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">adheres-<wbr></wbr>to-<wbr></wbr>schema?</span></a></td></tr><tr><td><a href="#%28def._%28%28lib._argo%2Fmain..rkt%29._check-json%2Fschema%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym">check-<wbr></wbr>json/<span class="mywbr"> &nbsp;</span>schema</span></a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="#%28part._.Technical_information%29" class="tocsubseclink" data-pltdoc="x">Technical information</a></td></tr><tr><td><span class="tocsublinknumber">4.1<tt>&nbsp;</tt></span><a href="#%28part._.Semantic_validation%29" class="tocsubseclink" data-pltdoc="x">Semantic validation</a></td></tr><tr><td><span class="tocsublinknumber">4.2<tt>&nbsp;</tt></span><a href="#%28part._.J.S.O.N_.Schema_versions%29" class="tocsubseclink" data-pltdoc="x">JSON Schema versions</a></td></tr><tr><td><span class="tocsublinknumber">5<tt>&nbsp;</tt></span><a href="#%28part._.Shortcomings_and_sorely_missing_features%29" class="tocsubseclink" data-pltdoc="x">Shortcomings and sorely missing features</a></td></tr><tr><td><span class="tocsublinknumber">5.1<tt>&nbsp;</tt></span><a href="#%28part._.Hypermedia_keywords_unsupported%29" class="tocsubseclink" data-pltdoc="x">Hypermedia keywords unsupported</a></td></tr><tr><td><span class="tocsublinknumber">5.2<tt>&nbsp;</tt></span><a href="#%28part._error-reporting%29" class="tocsubseclink" data-pltdoc="x">Error reporting</a></td></tr><tr><td><span class="tocsublinknumber">5.3<tt>&nbsp;</tt></span><a href="#%28part._.Only_version_6_of_the_.J.S.O.N_.Schema_specification_is_supported%29" class="tocsubseclink" data-pltdoc="x">Only version 6 of the JSON Schema specification is supported</a></td></tr><tr><td><span class="tocsublinknumber">6<tt>&nbsp;</tt></span><a href="#%28part._.Further_reading%29" class="tocsubseclink" data-pltdoc="x">Further reading</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="versionNoNav">6.10</span></div><h2><a name="(part._.Argo__.J.S.O.N_.Schema_.Adventures)"></a><a name="(mod-path._argo)"></a>Argo: JSON Schema Adventures</h2><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Jesse Alama &lt;<a href="mailto:jesse@lisp.sh">jesse@lisp.sh</a>&gt;</p></span></div><p><table cellspacing="0" cellpadding="0" class="defmodule"><tr><td align="left"><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">require</span></span></span><span class="stt"> </span><a href="file:///Users/jesse/Dropbox/sources/argo/scribblings/argo.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">argo</span></a><span class="RktPn">)</span></td><td align="right"><span class="RpackageSpec"><span class="Smaller">&nbsp;package:</span> <span class="stt">argo</span></span></td></tr></table></p><p>Argo is a JSON Schema validator. Work with your JSON data knowing that it adheres to some sensible constraints. If you have to work with JSON, even if only occasionally, you may want to consider validating it (that is, checking that is satisfies</p><p>Argo is a library that exports only one function: <span class="RktSym">adheres-to-schema?</span>. That function takes a JSON Schema and a JSON document and returns a boolean value. <span class="RktVal">#t</span> means that the document adheres to the schema; <span class="RktVal">#f</span> means it does not.</p><h3>1<tt>&nbsp;</tt><a name="(part._.Installation)"></a>Installation</h3><p>To install Argo from the command line, use the raco pkg install command, like so:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">raco pkg install argo</span></p></td></tr></table></p><p>After Argo has been installed, you can keep it up-to-date using raco pkg update:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">raco pkg update argo</span></p></td></tr></table></p><h3>2<tt>&nbsp;</tt><a name="(part._.Running_.Argo)"></a>Running Argo</h3><p>Argo can be executed as a command-line tool using <span class="stt">raco</span>. This section discusses the available commands.</p><h4>2.1<tt>&nbsp;</tt><a name="(part._validate)"></a><span class="stt">validate</span></h4><p>The <span class="stt">validate</span> command takes a JSON Schema file and a JSON file as input and checks that the data adheres to the schema.</p><p>Run it like this:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">raco argo validate schema.json data.json</span></p></td></tr></table></p><p>You will see either <span class="stt">Validation succeeded</span> or <span class="stt">Validation failed</span>.</p><p>In case of validation success, seeing &ldquo;Validation succeeded&rdquo; is probably enough. In case of failure, &ldquo;Validation failed&rdquo; is, admittedly, not the most informative thing you&rsquo;ve seen today. See also <a href="file:///Users/jesse/Dropbox/sources/argo/scribblings/argo.html#%28part._error-reporting%29" data-pltdoc="x">Error reporting</a>.</p><h5>2.1.1<tt>&nbsp;</tt><a name="(part._validate-exit-code)"></a>Exit code</h5><p><span class="stt">validate</span> exits cleanly (with code 0) provided:</p><ul><li><p>exactly two arguments, <span class="stt">schema.json</span> and <span class="stt">data.json</span>, were supplied to it,</p></li><li><p><span class="stt">schema.json</span> exists and is a file,</p></li><li><p><span class="stt">data.json</span> exists and is a file,</p></li><li><p><span class="stt">schema.json</span> is well-formed JSON,</p></li><li><p><span class="stt">data.json</span> is well-formed JSON,</p></li><li><p><span class="stt">schema.json</span> is a (draft 6) JSON Schema, and</p></li><li><p><span class="stt">data.json</span> adheres to <span class="stt">schema.json</span> (following the draft 6 semantics).</p></li></ul><p>If any of these conditions fails, the exit code will be 1.</p><h5>2.1.2<tt>&nbsp;</tt><a name="(part._.Options)"></a>Options</h5><p>The command accepts only one option, <span class="stt">quiet</span>, which, if set, will cause all output to be suppressed. By default, this option is unset. In such a case, the exit code will be your only indication about the validity of your data. Here&rsquo;s how you can use this option:</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">raco argo validate --quiet schema.json data.json</span></p></td></tr></table></p><p>As discussed in the <a href="file:///Users/jesse/Dropbox/sources/argo/scribblings/argo.html#%28part._validate-exit-code%29" data-pltdoc="x">Exit code</a>, there are seven conditions that need to be met for <span class="stt">validate</span> to exit cleanly. Looking at that list there, another way to think of it is that there are six preconditions that need to be met for validation to even make sense. Even if the <span class="stt">quiet</span> flag is set, you will see error output if any of these preconditions is not met. Thus</p><p><table cellspacing="0" cellpadding="0"><tr><td><p><span class="stt">raco argo validate --quiet schema.json</span></p></td></tr></table></p><p>will cause an error message to be printed, despite the <span class="stt"></span><span class="stt">&ndash;</span><span class="stt">quiet</span>, because this isn&rsquo;t even a well-formed invocation of <span class="stt">validate</span> (notice that the second argument is missing).</p><h3>3<tt>&nbsp;</tt><a name="(part._.Library_interface)"></a>Library interface</h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._argo/main..rkt)._json-schema~3f))"></a><span title="Provided from: argo | Package: argo"><span class="RktSym"><span class="RktSymDef RktSym">json-schema?</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">schema</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">boolean?</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">schema</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any</span></td></tr></table></blockquote></div><div class="SIntrapara">Return <span class="RktVal">#t</span> if <span class="RktVar">schema</span> is a <span class="RktSym"><span class="badlink"><span class="RktValLink">jsexpr?</span></span></span> value that counts as a JSON Schema.</div></p><p>&ldquo;JSON Schema&rdquo; for Argo means &ldquo;draft 6 JSON Schema&rdquo;, which was the current version of the JSON Schema specification when Argo was conceived. If you&rsquo;ve worked with JSON Schema over the years, chances are good you&rsquo;ve become accustomed to draft 4 schemas. They&rsquo;re largely the same, and for many users, they may be indistinguishable; but they&rsquo;re not identical. This means that what passed for a schema in the halcyon days of 2016 may not be a schema in Argo&rsquo;s eyes. (And vice versa: Argo may accept as a schema something that would be rejected according to the draft 4 rules.)</p><p>The meatiest function of Argo is <span class="stt">adheres-to-schema?</span>.</p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._argo/main..rkt)._adheres-to-schema~3f))"></a><span title="Provided from: argo | Package: argo"><span class="RktSym"><span class="RktSymDef RktSym">adheres-to-schema?</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">data</span><span class="hspace">&nbsp;</span><span class="RktVar">schema</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">boolean?</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">data</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">jsexpr?</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">schema</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">jsexpr?</span></span></span></td></tr></table></blockquote></div><div class="SIntrapara">Return <span class="RktVal">#t</span> if <span class="RktVar">schema</span> is a (draft 6) JSON Schema and <span class="RktVar">data</span> adheres to <span class="RktVar">schema</span>, otherwise <span class="RktVal">#f</span>.</div></p><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>procedure</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(def._((lib._argo/main..rkt)._check-json/schema))"></a><span title="Provided from: argo | Package: argo"><span class="RktSym"><span class="RktSymDef RktSym">check-json/schema</span></span></span><span class="hspace">&nbsp;</span><span class="RktVar">data</span><span class="hspace">&nbsp;</span><span class="RktVar">schema</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span>&rarr;<span class="hspace">&nbsp;</span><span class="RktSym"><span class="badlink"><span class="RktValLink">void</span></span></span></p></blockquote></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">data</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">schema</span><span class="hspace">&nbsp;</span>:<span class="hspace">&nbsp;</span><span class="RktSym">any</span></td></tr></table></blockquote></div><div class="SIntrapara">Returns <span class="RktSym"><span class="badlink"><span class="RktValLink">void</span></span></span> if (1) <span class="stt">data</span> is a <span class="RktSym"><span class="badlink"><span class="RktValLink">jsexpr?</span></span></span> value, (2) <span class="stt">schema</span> is a JSON Schema, and (3) <span class="stt">data</span> adheres to <span class="stt">schema</span>. Otherwise, an exception is thrown. If cases (1) or (2) fail, the exception is an <span class="RktSym"><span class="badlink"><span class="RktValLink">exn:fail:contract?</span></span></span>; if case (3) fails, the exception is an <span class="RktSym"><span class="badlink"><span class="RktValLink">exn:fail?</span></span></span> value.</div></p><h3>4<tt>&nbsp;</tt><a name="(part._.Technical_information)"></a>Technical information</h3><h4>4.1<tt>&nbsp;</tt><a name="(part._.Semantic_validation)"></a>Semantic validation</h4><p>Argo supports all the semantic validation keywords:</p><ul><li><p><span class="stt">date-time</span> (<a href="https://tools.ietf.org/html/rfc3339" class="plainlink">RFC 3399</a>)</p></li><li><p><span class="stt">email</span> (<a href="http://tools.ietf.org/html/rfc5322" class="plainlink">RFC 5322</a>)</p></li><li><p><span class="stt">hostname</span> (<a href="https://tools.ietf.org/html/rfc1034" class="plainlink">RFC 1034</a>)</p></li><li><p><span class="stt">ipv4</span> (<a href="https://tools.ietf.org/html/rfc2673" class="plainlink">RFC 2673</a>)</p></li><li><p><span class="stt">ipv6</span> (<a href="https://tools.ietf.org/html/rfc2373" class="plainlink">RFC 2373</a>)</p></li><li><p><span class="stt">uri</span> (<a href="https://tools.ietf.org/html/rfc3986" class="plainlink">RFC 3986</a>)</p></li><li><p><span class="stt">uri-reference</span> (<a href="https://tools.ietf.org/html/rfc3986" class="plainlink">ditto</a>)</p></li><li><p><span class="stt">uri-template</span> (<a href="https://tools.ietf.org/html/rfc6570" class="plainlink">RFC 6570</a>), and</p></li><li><p><span class="stt">json-pointer</span> (<a href="https://tools.ietf.org/html/rfc6901" class="plainlink">RFC 6901</a>)</p></li></ul><h4>4.2<tt>&nbsp;</tt><a name="(part._.J.S.O.N_.Schema_versions)"></a>JSON Schema versions</h4><p>JSON Schema is a moving target. Thankfully, the target moves slowly. But it <span style="font-style: italic">does</span> move. What does that mean for you? To put it bluntly: a JSON document that&rsquo;s valid today may not be valid tomorrow.</p><p>Argo implements JSON Schema version 6 (codename &ldquo;draft-wright-json-schema-validation-01&rdquo;). The official homepage for specification that Argo follows is <a href="http://json-schema.org/latest/json-schema-validation.html" class="plainlink">here</a>. That version was released on April 21, 2017.  If you&rsquo;ve been working with JSON Schema for a few years, chances are good that you&rsquo;ve worked with version 4. The two versions are largely the same, but there are some minor differences. Unfortunately, what counts as a &ldquo;minor difference&rdquo; is in the eyes of the beholder. While testing Argo I found several schemas on the web, written in the heyday of version 4&#8212;<wbr></wbr>including some on the JSON Schema homepage&#8212;<wbr></wbr>that no longer produced the expected results when interpreted as version 6 schemas. They had to be updated. It may very well be possible that you&rsquo;ll need to update your JSON Schemas, too.</p><h3>5<tt>&nbsp;</tt><a name="(part._.Shortcomings_and_sorely_missing_features)"></a>Shortcomings and sorely missing features</h3><p>Argo suffers from some known deficiencies.</p><h4>5.1<tt>&nbsp;</tt><a name="(part._.Hypermedia_keywords_unsupported)"></a>Hypermedia keywords unsupported</h4><p>JSON Schema defines Hypermedia keywords (base, links, media) are currently not supported. When these properties are encountered on a JSON schema, they are silently ignored. If you work with JSON schema that rely on these features, it will almost certainly not work with Argo. (Meanining: validation will produce many false negatives and maybe even some false positives.)</p><h4>5.2<tt>&nbsp;</tt><a name="(part._error-reporting)"></a>Error reporting</h4><p>Error reporting is largely (or should I say, entirely) missing. Thus, if a JSON document is not valid according to a JSON schema, you just get <span class="RktVal">#f</span>. You don&rsquo;t get a description of <span style="font-style: italic">why</span> the document fails validation.</p><h4>5.3<tt>&nbsp;</tt><a name="(part._.Only_version_6_of_the_.J.S.O.N_.Schema_specification_is_supported)"></a>Only version 6 of the JSON Schema specification is supported</h4><p>Only verson 6 of the JSON Schema specification is supported. Schema that declare themselves to be, say, a v4 JSON Schema may not be treated correctly (that is, according to the v4 rules). If you can, either leave out the $schema keyword or use the value "http://json-schema.org/draft-06/schema#" for $schema.</p><h3>6<tt>&nbsp;</tt><a name="(part._.Further_reading)"></a>Further reading</h3><p>To learn more about JSON Schema, go to the source: <a href="http://json-schema.org"><span class="url">http://json-schema.org</span></a>. The specificiations that Argo aims to follow are in two documents:</p><ul><li><p><a href="http://json-schema.org/latest/json-schema-core.html" class="plainlink">JSON Schema Core</a></p></li><li><p><a href="http://json-schema.org/latest/json-schema-validation.html" class="plainlink">JSON Schema Validation</a></p></li></ul><p>(The third part of the JSON Schema specification that is currently <span style="font-style: italic">not</span> implemented by Argo is <a href="http://json-schema.org/latest/json-schema-hypermedia.html" class="plainlink">JSON Hyper-Schema</a>.)</p><p>Finally, you&rsquo;re welcome to visit <a href="http://argojson.com" class="plainlink">the Argo homepage</a> to read about updates and other JSON Schema goodies.</p></div></div><div id="contextindicator">&nbsp;</div></body></html>